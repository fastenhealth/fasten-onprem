<form (ngSubmit)="onSubmit()" [formGroup]="form" class="w-100 display-flex justify-center flex-column">
    <div class="justify-content-between align-items-center mb-3 container my-4 display-flex flex-column">
        <div *ngIf="debugMode" class="alert alert-warning">
            <pre><code [highlight]="form.getRawValue() | json"></code></pre>
            <strong>Form Status: {{ form.status }}</strong>
        </div>

        <div class="card p-4 w-100">
            <!-- Encounter Section -->
            <div class="mb-4">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <h6 class="section-title mb-3">
                        <i class="fas fa-user-md me-2"></i>Encounter
                    </h6>

                    <button type="button" (click)="handleEditModeToggle()" class="btn btn-primary btn-indigo">
                        <i class="fas" [ngClass]="editMode ? 'fa-save' : 'fa-pen'"></i>
                        {{ editMode ? 'Save' : 'Edit' }}
                    </button>
                </div>


                <div *ngIf="existingEncounter && !editMode; else addEncounter">
                    <fhir-card [showDetails]="false" [displayModel]="existingEncounter" [isCollapsed]="true"
                        [isEditable]="fastenSourceId == existingEncounter.source_id"
                        (editRequested)="openEditEncounterModal(existingEncounter)"></fhir-card>
                </div>
                <ng-template #addEncounter>
                    <div class="row row-sm pd-t-15">
                        <ng-container [formGroup]="form.get('encounter.data')">
                            <div class="col-12">
                                <p class="mg-b-10">Encounter Type<span ngbTooltip="required"
                                        class="text-danger">*</span></p>
                                <app-nlm-typeahead formControlName="code" searchType="EncounterServiceType"
                                    [debugMode]="debugMode"></app-nlm-typeahead>
                            </div><!-- col -->
                            <div class="col-6 mg-t-10 mg-lg-t-0">
                                <p class="mg-b-10">Start<span ngbTooltip="required" class="text-danger">*</span></p>
                                <input formControlName="period_start" class="form-control" placeholder="yyyy-mm-dd"
                                    name="dp" ngbDatepicker #cds="ngbDatepicker" (click)="cds.toggle()">
                            </div><!-- col -->
                            <div class="col-6 mg-t-10 mg-lg-t-0">
                                <p class="mg-b-10">End</p>
                                <input formControlName="period_end" [minDate]="form.get('period_start')?.value"
                                    class="form-control" placeholder="yyyy-mm-dd" name="dp" ngbDatepicker
                                    #cde="ngbDatepicker" (click)="cde.toggle()">
                            </div><!-- col -->
                        </ng-container>
                    </div>
                </ng-template>
            </div>

            <!-- Medications Section -->
            <div class="mb-4">
                <h6 class="section-title mb-3">
                    <i class="fas fa-pills me-2"></i>
                    Medications
                    <span class="badge bg-warning ms-2"
                        *ngIf="medications.controls.length">{{medications.controls.length}}</span>
                </h6>

                <fhir-card *ngFor="let medication of existingEncounter?.related_resources?.['Medication']"
                    [showDetails]="false" [displayModel]="medication" [isCollapsed]="true"
                    [isEditable]="fastenSourceId == medication.source_id"
                    (unlinkRequested)="handleUnlinkRequested(medication)"
                    (editRequested)="openEditMedicationModal(medication)"></fhir-card>

                <ng-container formArrayName="medications">
                    <div class="border rounded p-3 mb-3" [formGroup]="medicationGroup"
                        *ngFor="let medicationGroup of medications.controls; let i = index">
                        <div *ngIf="debugMode" class="alert alert-warning">
                            <strong>Medication Status: {{medicationGroup.status}}</strong>
                        </div>
                        <div class="text-end">
                            <span class="cursor-pointer" (click)="deleteMedication(i)" aria-hidden="true">
                                <i class="fas fa-trash text-danger"></i>
                            </span>
                        </div>
                        <div class="row">
                            <div class="col-lg-6">
                                <label class="form-label">Medication name<span class="text-danger">*</span></label>
                                <app-nlm-typeahead formControlName="data" searchType="Medication"
                                    [debugMode]="debugMode"></app-nlm-typeahead>
                            </div>
                            <div class="col-lg-3 mt-2 mt-lg-0">
                                <label class="form-label">Status<span class="text-danger">*</span></label>
                                <select formControlName="status" class="form-control">
                                    <option value="" hidden selected>Select Status</option>
                                    <option value="active">Active</option>
                                    <option value="stopped">Stopped</option>
                                </select>
                            </div>
                            <div class="col-lg-3 mt-2 mt-lg-0">
                                <label class="form-label">Dosage</label>
                                <input formControlName="dosage" class="form-control" placeholder="Input box"
                                    type="text">
                            </div>
                            <div class="col-lg-3 mt-2">
                                <label class="form-label">Started<span class="text-danger">*</span></label>
                                <input formControlName="started" class="form-control" placeholder="yyyy-mm-dd"
                                    ngbDatepicker #ds="ngbDatepicker" (click)="ds.toggle()">
                            </div>
                            <div class="col-lg-3 mt-2">
                                <label class="form-label">Stopped</label>
                                <input [minDate]="medicationGroup.get('started').value" formControlName="stopped"
                                    class="form-control" placeholder="yyyy-mm-dd" ngbDatepicker #dstop="ngbDatepicker"
                                    (click)="dstop.toggle()">
                            </div>
                            <div class="col-lg-3 mt-2">
                                <label class="form-label">Why Stopped</label>
                                <app-nlm-typeahead formControlName="whystopped" searchType="MedicationWhyStopped"
                                    [debugMode]="debugMode"></app-nlm-typeahead>
                            </div>
                            <div class="col-lg-3 mt-2">
                                <label class="form-label">Prescribing Practitioner<span
                                        class="text-danger">*</span></label>
                                <select class="form-control" formControlName="requester">
                                    <option value="" hidden selected>Select Practitioner</option>
                                    <option value="" (click)="openPractitionerModal(medicationGroup, 'requester')">
                                        New Practitioner</option>
                                    <option *ngFor="let practitioner of foundPractitioners; let i = index"
                                        [ngValue]="practitioner">
                                        {{practitioner?.name?.[0].displayName}}
                                    </option>
                                </select>
                            </div>
                        </div>
                        <div class="row mt-3">
                            <div class="col-lg-12">
                                <label class="form-label">Instructions</label>
                                <textarea formControlName="instructions" rows="3" class="form-control"
                                    placeholder="Textarea"></textarea>
                            </div>
                        </div>
                        <div class="row mt-3">
                            <div class="col-12">
                                <label class="form-label">Attachments</label>
                            </div>
                            <div class="col-auto">
                                <button type="button" (click)="openAttachmentModal(medicationGroup, 'attachments')"
                                    class="btn btn-primary btn-indigo">
                                    <i class="fas fa-paperclip"></i> Add
                                </button>
                            </div>
                            <div class="col">
                                <ng-select class="ng-select-form-control" [readonly]="!attachments.controls.length"
                                    appendTo="body" formControlName="attachments" placeholder="Select Attachment"
                                    [multiple]="true" [hideSelected]="true">
                                    <ng-option *ngFor="let attachment of attachments.controls; let i = index"
                                        [value]="attachment.value.id">{{attachment.value.name}}
                                        ({{attachment.value.file_name}})</ng-option>
                                </ng-select>
                            </div>
                        </div>
                    </div>
                </ng-container>

                <div class="row">
                    <div class="col-auto">
                        <button type="button" (click)="addMedication()" class="btn btn-outline-indigo">Add
                            Medication</button>
                    </div>
                </div>
            </div>

            <!-- Procedures Section -->
            <div class="mb-4">
                <h6 class="section-title mb-3">
                    <i class="fas fa-user-md me-2"></i>
                    Procedures
                    <span class="badge bg-warning ms-2"
                        *ngIf="procedures.controls.length">{{procedures.controls.length}}</span>
                </h6>

                <fhir-card *ngFor="let procedure of existingEncounter?.related_resources?.['Procedure']"
                    [showDetails]="false" [displayModel]="procedure" [isCollapsed]="true"
                    [isEditable]="fastenSourceId == procedure.source_id"
                    (unlinkRequested)="handleUnlinkRequested(procedure)"
                    (editRequested)="openEditProcedureModal(procedure)"></fhir-card>

                <ng-container formArrayName="procedures">
                    <div class="border rounded p-3 mb-3" [formGroup]="procedureGroup"
                        *ngFor="let procedureGroup of procedures.controls; let i = index">
                        <div *ngIf="debugMode" class="alert alert-warning">
                            <strong>Procedure Status: {{procedureGroup.status}}</strong>
                        </div>
                        <div class="text-end">
                            <span class="cursor-pointer" (click)="deleteProcedure(i)" aria-hidden="true">
                                <i class="fas fa-trash text-danger"></i>
                            </span>
                        </div>
                        <div class="row">
                            <div class="col-lg-8">
                                <label class="form-label">Surgery or Implant<span class="text-danger">*</span></label>
                                <app-nlm-typeahead formControlName="data" searchType="Procedure"
                                    [debugMode]="debugMode"></app-nlm-typeahead>
                            </div>
                            <div class="col-lg-4 mt-2 mt-lg-0">
                                <label class="form-label">When done<span class="text-danger">*</span></label>
                                <input formControlName="whendone" class="form-control" placeholder="yyyy-mm-dd"
                                    ngbDatepicker #dwd="ngbDatepicker" (click)="dwd.toggle()">
                            </div>
                            <div class="col-lg-6 mt-2">
                                <label class="form-label">Performed By</label>
                                <select class="form-control" formControlName="performer">
                                    <option value="" hidden selected>Select Practitioner</option>
                                    <option value="" (click)="openPractitionerModal(procedureGroup, 'performer')">
                                        New Practitioner</option>
                                    <option *ngFor="let practitioner of foundPractitioners; let i = index"
                                        [ngValue]="practitioner">
                                        {{practitioner?.name?.[0].displayName}}
                                    </option>
                                </select>
                            </div>
                            <div class="col-lg-6 mt-2">
                                <label class="form-label">Location</label>
                                <select class="form-control" formControlName="location">
                                    <option value="" hidden selected>Select Location</option>
                                    <option value="" (click)="openOrganizationModal(procedureGroup, 'location')">New
                                        Organization</option>
                                    <optgroup *ngIf="existingEncounter?.related_resources?.['Organization']?.length"
                                        class="divider">---</optgroup>
                                    <option
                                        *ngFor="let organization of existingEncounter?.related_resources?.['Organization']; let i = index"
                                        [value]="organization">
                                        {{organization?.name }}
                                    </option>
                                    <optgroup *ngIf="organizations.controls.length" class="divider"></optgroup>
                                    <option *ngFor="let organization of organizations.controls; let i = index"
                                        [value]="organization.controls?.data?.value">
                                        {{organization.controls?.data?.value?.name}}
                                        ({{organization.controls?.data?.value?.address}})
                                    </option>
                                </select>
                            </div>
                            <div class="col-lg-12 mt-2">
                                <label class="form-label">Comments</label>
                                <textarea formControlName="comment" class="form-control" placeholder="Input box"
                                    rows="3"></textarea>
                            </div>
                        </div>
                        <div class="row mt-3">
                            <div class="col-12">
                                <label class="form-label">Attachments</label>
                            </div>
                            <div class="col-auto">
                                <button type="button" (click)="openAttachmentModal(procedureGroup, 'attachments')"
                                    class="btn btn-primary btn-indigo">
                                    <i class="fas fa-paperclip"></i> Add
                                </button>
                            </div>
                            <div class="col">
                                <ng-select class="ng-select-form-control" [readonly]="!attachments.controls.length"
                                    formControlName="attachments" placeholder="Select Attachment" [multiple]="true"
                                    [hideSelected]="true">
                                    <ng-option *ngFor="let attachment of attachments.controls; let i = index"
                                        [value]="attachment.value.id">{{attachment.value.name}}
                                        ({{attachment.value.file_name}})</ng-option>
                                </ng-select>
                            </div>
                        </div>
                    </div>
                </ng-container>

                <div class="row">
                    <div class="col-auto">
                        <button type="button" (click)="addProcedure()" class="btn btn-outline-indigo">Add
                            Surgery or Implant</button>
                    </div>
                </div>
            </div>

            <!-- Practitioners Section -->
            <div class="mb-4">
                <h6 class="section-title mb-3">
                    <i class="fas fa-stethoscope me-2"></i>
                    Practitioners
                    <span class="badge bg-warning ms-2"
                        *ngIf="practitioners.controls.length">{{practitioners.controls.length}}</span>
                </h6>

                <fhir-card *ngFor="let practitioner of existingEncounter?.related_resources?.['Practitioner']"
                    [showDetails]="false" [displayModel]="practitioner" [isCollapsed]="true"
                    [isEditable]="fastenSourceId == practitioner.source_id"
                    (unlinkRequested)="handleUnlinkRequested(practitioner)"
                    (editRequested)="openEditPractitionerModal(practitioner)"></fhir-card>

                <ng-container formArrayName="practitioners">
                    <ng-container *ngFor="let practitionerGroup of practitioners.controls; let i = index"
                        [formGroupName]="i">
                        <div class="row row-sm">
                            <div class="col-12">
                                <p class="mg-b-10">
                                    Name<span ngbTooltip="required" class="text-danger">*</span>
                                </p>
                                <app-nlm-typeahead formControlName="name" searchType="MedicalContactIndividual"
                                    [debugMode]="debugMode"></app-nlm-typeahead>

                                <span *ngFor="let extId of practitionerGroup.get('identifier')?.value"
                                    class="badge badge-pill badge-primary">
                                    {{ extId.type?.coding[0].code }}: {{ extId.value }}
                                </span>
                            </div>

                            <div class="col-6 mg-t-10 mg-lg-t-0">
                                <p class="mg-b-10">Type<span ngbTooltip="required" class="text-danger">*</span></p>
                                <app-nlm-typeahead formControlName="profession"
                                    searchType="MedicalContactIndividualProfession"
                                    [debugMode]="debugMode"></app-nlm-typeahead>
                            </div>

                            <div class="col-6 mg-t-10 mg-lg-t-0">
                                <p class="mg-b-10">Telephone</p>
                                <input formControlName="phone" class="form-control" placeholder="(123) 456-7890"
                                    type="text" />
                            </div>

                            <div class="col-6 mg-t-10 mg-lg-t-0">
                                <p class="mg-b-10">Fax</p>
                                <input formControlName="fax" class="form-control" placeholder="(123) 456-7890"
                                    type="text" />
                            </div>

                            <div class="col-6 mg-t-10 mg-lg-t-0">
                                <p class="mg-b-10">Email</p>
                                <input formControlName="email" class="form-control" placeholder="email@example.com"
                                    type="text" />
                            </div>

                            <ng-container formGroupName="address">
                                <div class="col-12 mg-t-10 mg-lg-t-0">
                                    <p class="mg-b-10">Address</p>
                                    <input formControlName="line1" class="form-control" placeholder="Line 1"
                                        type="text" />
                                </div>
                                <div class="col-12 pd-t-10 mg-t-10 mg-lg-t-0">
                                    <input formControlName="line2" class="form-control" placeholder="Line 2"
                                        type="text" />
                                </div>
                                <div class="col-6 mg-t-10 mg-lg-t-0">
                                    <p class="mg-b-10">City</p>
                                    <input formControlName="city" class="form-control" placeholder="City" type="text" />
                                </div>
                                <div class="col-6 mg-t-10 mg-lg-t-0">
                                    <p class="mg-b-10">State</p>
                                    <input formControlName="state" class="form-control" placeholder="State"
                                        type="text" />
                                </div>
                                <div class="col-6 mg-t-10 mg-lg-t-0">
                                    <p class="mg-b-10">Zip/Postal</p>
                                    <input formControlName="zip" class="form-control" placeholder="Zip" type="text" />
                                </div>
                                <div class="col-6 mg-t-10 mg-lg-t-0">
                                    <p class="mg-b-10">Country</p>
                                    <app-nlm-typeahead formControlName="country" searchType="Countries"
                                        [debugMode]="debugMode"></app-nlm-typeahead>
                                </div>
                            </ng-container>
                        </div>
                    </ng-container>
                </ng-container>

                <div class="row mt-2">
                    <div class="col-auto">
                        <button type="button" (click)="openPractitionerModal()" class="btn btn-outline-indigo">Add
                            Practitioner</button>
                    </div>
                </div>
            </div>

            <!-- Organizations Section -->
            <div class="mb-4">
                <h6 class="section-title mb-3">
                    <i class="fas fa-hospital me-2"></i>
                    Organizations
                    <span class="badge bg-warning ms-2"
                        *ngIf="organizations.controls.length">{{organizations.controls.length}}</span>
                </h6>

                <fhir-card *ngFor="let organization of existingEncounter?.related_resources?.['Organization']"
                    [showDetails]="false" [displayModel]="organization" [isCollapsed]="true"
                    [isEditable]="fastenSourceId == organization.source_id"
                    (unlinkRequested)="handleUnlinkRequested(organization)"
                    (editRequested)="openEditOrganizationModal(organization)"></fhir-card>

                <ng-container formArrayName="organizations">
                    <ng-container *ngFor="let organizationGroup of organizations.controls; let i = index">
                        <div *ngIf="debugMode" class="alert alert-warning">
                            <strong>Organization Status: {{organizationGroup.status}}</strong>
                        </div>
                        <fhir-organization class="fhir-card-callout-warning mb-3" [formGroup]="organizationGroup"
                            [showDetails]="false" [displayModel]="organizationGroup.controls?.data?.value"
                            [isCollapsed]="true">
                            <div header>
                                <span class="cursor-pointer float-end" (click)="deleteOrganization(i)"
                                    aria-hidden="true"><i class="fas fa-trash text-danger"></i></span>
                            </div>
                        </fhir-organization>
                        <ng-container formArrayName="organizations">
                            <ng-container *ngFor="let organizationGroup of organizations.controls; let i = index"
                                [formGroupName]="i">
                                <div class="row row-sm">
                                    <div class="col-12">
                                        <p class="mg-b-10">
                                            Name <span ngbTooltip="required" class="text-danger">*</span>
                                        </p>
                                        <app-nlm-typeahead formControlName="name"
                                            searchType="MedicalContactOrganization"
                                            [debugMode]="debugMode"></app-nlm-typeahead>

                                        <span *ngFor="let extId of organizationGroup.get('identifier')?.value"
                                            class="badge badge-pill badge-primary">
                                            {{ extId.type?.coding[0].code }}: {{ extId.value }}
                                        </span>
                                    </div>

                                    <div class="col-6 mg-t-10 mg-lg-t-0">
                                        <p class="mg-b-10">Type <span ngbTooltip="required" class="text-danger">*</span>
                                        </p>
                                        <app-nlm-typeahead formControlName="type"
                                            searchType="MedicalContactOrganizationType"
                                            [debugMode]="debugMode"></app-nlm-typeahead>
                                    </div>

                                    <div class="col-6 mg-t-10 mg-lg-t-0">
                                        <p class="mg-b-10">Telephone</p>
                                        <input formControlName="phone" class="form-control" placeholder="(123) 456-7890"
                                            type="text" />
                                    </div>

                                    <div class="col-6 mg-t-10 mg-lg-t-0">
                                        <p class="mg-b-10">Fax</p>
                                        <input formControlName="fax" class="form-control" placeholder="(123) 456-7890"
                                            type="text" />
                                    </div>

                                    <div class="col-6 mg-t-10 mg-lg-t-0">
                                        <p class="mg-b-10">Email</p>
                                        <input formControlName="email" class="form-control"
                                            placeholder="email@example.com" type="email" />
                                    </div>

                                    <ng-container formGroupName="address">
                                        <div class="col-12 mg-t-10 mg-lg-t-0">
                                            <p class="mg-b-10">Address</p>
                                            <input formControlName="line1" class="form-control" placeholder="Line 1"
                                                type="text" />
                                        </div>

                                        <div class="col-12 pd-t-10 mg-t-10 mg-lg-t-0">
                                            <input formControlName="line2" class="form-control" placeholder="Line 2"
                                                type="text" />
                                        </div>

                                        <div class="col-6 mg-t-10 mg-lg-t-0">
                                            <p class="mg-b-10">City</p>
                                            <input formControlName="city" class="form-control" placeholder="City"
                                                type="text" />
                                        </div>

                                        <div class="col-6 mg-t-10 mg-lg-t-0">
                                            <p class="mg-b-10">State</p>
                                            <input formControlName="state" class="form-control" placeholder="State"
                                                type="text" />
                                        </div>

                                        <div class="col-6 mg-t-10 mg-lg-t-0">
                                            <p class="mg-b-10">Zip/Postal</p>
                                            <input formControlName="zip" class="form-control" placeholder="Zip"
                                                type="text" />
                                        </div>

                                        <div class="col-6 mg-t-10 mg-lg-t-0">
                                            <p class="mg-b-10">Country</p>
                                            <app-nlm-typeahead formControlName="country" searchType="Countries"
                                                [debugMode]="debugMode"></app-nlm-typeahead>
                                        </div>
                                    </ng-container>
                                </div>
                            </ng-container>
                        </ng-container>

                    </ng-container>
                </ng-container>
                <div class="row mt-2">
                    <div class="col-auto">
                        <button type="button" (click)="openOrganizationModal()" class="btn btn-outline-indigo">Add
                            Organization</button>
                    </div>
                </div>
            </div>

            <!-- Lab Results Section -->
            <div class="mb-4">
                <h6 class="section-title mb-3">
                    <i class="fas fa-vial me-2"></i>
                    Lab Results
                </h6>

                <fhir-card *ngFor="let diagnosticReport of existingEncounter?.related_resources?.['DiagnosticReport']"
                    [showDetails]="false" [displayModel]="diagnosticReport" [isCollapsed]="true"
                    [isEditable]="fastenSourceId == diagnosticReport.source_id"
                    (unlinkRequested)="handleUnlinkRequested(diagnosticReport)"
                    (editRequested)="openEditLabResultsModal(diagnosticReport)"></fhir-card>

                <ng-container formArrayName="labresults">
                    <ng-container *ngFor="let labresultsGroup of labresults.controls; let i = index">
                        <div *ngIf="debugMode" class="alert alert-warning">
                            <strong>Lab Results Status: {{labresultsGroup.status}}</strong>
                        </div>
                        <fhir-diagnostic-report class="fhir-card-callout-warning mb-3" [formGroup]="labresultsGroup"
                            [showDetails]="false"
                            [displayModel]="labresultsGroup.controls.data.value?.entry?.[0]?.resource | fastenDisplayModel"
                            [isCollapsed]="true">
                            <div header>
                                <span class="cursor-pointer float-end" (click)="deleteLabResults(i)"
                                    aria-hidden="true"><i class="fas fa-trash text-danger"></i></span>
                            </div>
                        </fhir-diagnostic-report>
                    </ng-container>
                </ng-container>

                <div class="row">
                    <div class="col-auto">
                        <button type="button" (click)="openLabResultsModal()" class="btn btn-outline-indigo">Create Lab
                            Result</button>
                    </div>
                </div>
            </div>

            <!-- Attachments Section -->
            <div class="mb-4">
                <h6 class="section-title mb-3">
                    <i class="fas fa-paperclip me-2"></i>
                    Attachments
                    <span class="badge bg-warning ms-2"
                        *ngIf="attachments.controls.length">{{attachments.controls.length}}</span>
                </h6>

                <ng-container formArrayName="attachments">
                    <div class="border rounded p-3 mb-3" [formGroup]="attachmentGroup"
                        *ngFor="let attachmentGroup of attachments.controls; let i = index">
                        <div *ngIf="debugMode" class="alert alert-warning">
                            <strong>Attachment Status: {{attachmentGroup.status}}</strong>
                        </div>
                        <div class="text-end">
                            <span class="cursor-pointer" (click)="deleteAttachment(i)" aria-hidden="true">
                                <i class="fas fa-trash text-danger"></i>
                            </span>
                        </div>

                        <div class="row">
                            <input formControlName="id" class="form-control" type="hidden">
                            <div class="col-lg-4">
                                <label class="form-label">Name<span class="text-danger">*</span></label>
                                <input formControlName="name" readonly class="form-control" placeholder="Input box"
                                    type="text">
                            </div>
                            <div class="col-lg-4 mt-2 mt-lg-0">
                                <label class="form-label">Category</label>
                                <app-nlm-typeahead formControlName="category" searchType="AttachmentCategory"
                                    [debugMode]="debugMode"></app-nlm-typeahead>
                            </div>
                            <div class="col-lg-4 mt-2 mt-lg-0">
                                <label class="form-label">File Type</label>
                                <input readonly class="form-control" formControlName="file_type" />
                            </div>
                        </div>
                    </div>
                </ng-container>

                <div class="row">
                    <div class="col-auto">
                        <button type="button" (click)="openAttachmentModal()" class="btn btn-outline-indigo">Create
                            Attachment/Document</button>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <div>
        <button [ngClass]="{
    'btn-outline-dark': !debugMode,
    'text-dark': !debugMode,
    'btn-dark':debugMode,
    'text-white':debugMode
     }" type="button" class="btn mr-2" (click)="debugMode = !debugMode">
            <i class="fas fa-bug"></i>
        </button>
        <button type="submit" class="btn btn-indigo" [disabled]="submitWizardLoading">
            Save
        </button>
    </div>
</form>